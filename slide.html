<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>行列と画像処理の数理 (全6枚)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Noto Sans JP', sans-serif; 
            background-color: #525659; 
            margin: 0;
            padding: 40px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
        }
        .slide { 
            width: 1280px; 
            height: 720px; 
            background: white; 
            position: relative; 
            overflow: hidden; 
            flex-shrink: 0;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
        }
        /* Code Syntax Highlighting Sim */
        .code-block { background: #1e1e1e; color: #d4d4d4; font-family: 'JetBrains Mono', monospace; padding: 1rem; border-radius: 0.5rem; }
        .kw { color: #569cd6; } /* keyword */
        .var { color: #9cdcfe; } /* variable */
        .num { color: #b5cea8; } /* number */
        .func { color: #dcdcaa; } /* function */
        .comment { color: #6a9955; } /* comment */
        
        @media print {
            body { background: none; padding: 0; gap: 0; display: block; }
            .slide { box-shadow: none; page-break-after: always; margin: 0; }
        }
    </style>
</head>
<body>

    <div class="slide justify-center items-center bg-slate-50">
        <div class="text-center z-10">
            <div class="text-blue-600 font-bold tracking-widest mb-4 uppercase text-sm">
                Linear Algebra Final Presentation
            </div>
            <h1 class="text-5xl font-black text-slate-800 leading-tight mb-6">
                行列による画像変換の<br>
                <span class="text-blue-600">数理と実装</span>
            </h1>
            <p class="text-xl text-slate-600 mb-12">
                行列の式(Ax)はプログラムの中でどう動くのか。<br>
                <span class="font-mono text-sm bg-slate-200 px-2 py-1 rounded">draft.py</span> から <span class="font-mono text-sm bg-slate-200 px-2 py-1 rounded">sample.py</span> への進化過程。
            </p>
            
            <div class="flex justify-center gap-8 opacity-80">
                <div class="w-32 h-32 bg-white p-2 shadow-lg transform -rotate-6">
                    <img src="./input.jpeg" alt="Input" class="w-full h-full object-cover">
                    <div class="text-xs text-center mt-1">Before</div>
                </div>
                <div class="text-4xl text-slate-300 self-center">
                    <i class="fas fa-arrow-right"></i>
                </div>
                <div class="w-32 h-32 bg-white p-2 shadow-lg transform rotate-6">
                    <img src="./output.png" alt="Output" class="w-full h-full object-cover">
                    <div class="text-xs text-center mt-1">After</div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide">
        <div class="w-full h-20 border-b border-slate-200 flex items-center px-12 bg-white">
            <h2 class="text-2xl font-bold text-slate-800">1. 初期の試み (draft.py)</h2>
        </div>
        
        <div class="flex flex-1 p-8 gap-8">
            <div class="w-1/2 flex flex-col gap-6">
                <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
                    <h3 class="font-bold text-blue-800 mb-2">単純な回転行列</h3>
                    <p class="text-sm text-slate-600 mb-4">原点(0,0)を中心とした回転数式をそのまま実装。</p>
                    <div class="font-serif italic text-xl text-center">
                        x' = x cosθ - y sinθ<br>
                        y' = x sinθ + y cosθ
                    </div>
                </div>

                <div class="code-block text-sm flex-1">
<span class="comment"># draft.py の実装</span>
<span class="kw">for</span> y <span class="kw">in</span> <span class="func">range</span>(360):
  <span class="kw">for</span> x <span class="kw">in</span> <span class="func">range</span>(360):
    <span class="comment"># 数式通りの実装</span>
    calc_x = math.cos(r)*x - math.sin(r)*y
    calc_y = math.sin(r)*x + math.cos(r)*y
    
    <span class="comment"># 整数丸め</span>
    x2 = <span class="func">int</span>(<span class="func">round</span>(calc_x))
    y2 = <span class="func">int</span>(<span class="func">round</span>(calc_y))
    
    out[y2, x2] = arr[y, x]
                </div>
            </div>

            <div class="w-1/2 flex flex-col items-center justify-center bg-slate-100 rounded-xl relative">
                <div class="absolute top-4 left-4 font-bold text-slate-500">実行結果</div>
                
                <div class="grid grid-cols-2 gap-4 w-full px-8">
                    <div class="text-center">
                        <div class="bg-white p-2 shadow mb-2 h-40 flex items-center justify-center border-2 border-green-400">
                            <span class="text-green-600 font-bold">成功</span>
                        </div>
                        <p class="font-bold">90度回転</p>
                        <p class="text-xs text-slate-500">整数→整数への変換のため<br>綺麗に回る</p>
                    </div>
                    <div class="text-center">
                        <div class="bg-white p-2 shadow mb-2 h-40 flex items-center justify-center border-2 border-red-400 relative overflow-hidden">
                            <div class="absolute inset-0 flex items-center justify-center text-slate-200 text-6xl opacity-20"><i class="fas fa-bug"></i></div>
                            <span class="text-red-600 font-bold z-10">崩壊</span>
                        </div>
                        <p class="font-bold">45度回転</p>
                        <p class="text-xs text-slate-500">座標がマイナスになり切れる<br>穴が開く</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide">
        <div class="w-full h-20 border-b border-slate-200 flex items-center px-12 bg-white">
            <h2 class="text-2xl font-bold text-slate-800">2. なぜ draft.py は失敗したか</h2>
        </div>
        
        <div class="flex flex-1 p-12 gap-12 items-center bg-slate-50">
            <div class="w-1/2 bg-white p-8 rounded-xl shadow-lg border-t-4 border-purple-500 h-full">
                <h3 class="text-xl font-bold text-purple-700 mb-4"><i class="fas fa-arrows-alt mb-2 mr-2"></i>問題A: 回転の中心</h3>
                <p class="text-slate-600 mb-6">
                    画像データは左上 $(0,0)$ が原点。<br>
                    そのまま回転行列をかけると、<span class="font-bold text-red-500">原点中心に大きく移動</span>してしまう。
                </p>
                <div class="bg-slate-100 h-48 rounded relative overflow-hidden border border-slate-300">
                    <div class="absolute top-0 left-0 w-2 h-2 bg-black rounded-full z-10"></div>
                    <div class="absolute top-2 left-2 text-xs font-mono">Origins(0,0)</div>
                    <div class="absolute top-10 left-10 w-24 h-24 bg-blue-200 border-2 border-blue-500 flex items-center justify-center opacity-50">Before</div>
                    <div class="absolute top-[-20px] left-[-40px] w-24 h-24 bg-red-200 border-2 border-red-500 flex items-center justify-center transform -rotate-45">After</div>
                </div>
                <p class="text-right text-red-500 font-bold text-sm mt-2">画面外へ消失！</p>
            </div>

            <div class="w-1/2 bg-white p-8 rounded-xl shadow-lg border-t-4 border-red-500 h-full">
                <h3 class="text-xl font-bold text-red-700 mb-4"><i class="fas fa-th mb-2 mr-2"></i>問題B: 順方向マッピングの穴</h3>
                <p class="text-slate-600 mb-6">
                    $x' = 100.7$ などの計算結果を無理やり整数に丸めると、<br>
                    <span class="font-bold text-red-500">「誰も来ないマス」</span>が発生する。
                </p>
                <div class="flex justify-center items-center gap-2">
                    <div class="flex flex-col items-center">
                        <div class="w-12 h-12 bg-blue-500 text-white flex items-center justify-center rounded mb-1">P1</div>
                        <i class="fas fa-arrow-right text-slate-400 transform rotate-12"></i>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="w-12 h-12 bg-blue-500 text-white flex items-center justify-center rounded mb-1">P2</div>
                        <i class="fas fa-arrow-right text-slate-400 transform -rotate-12"></i>
                    </div>
                    
                    <div class="w-px h-24 bg-slate-300 mx-4"></div>

                    <div class="grid grid-cols-3 gap-1">
                        <div class="w-12 h-12 bg-slate-200 border border-slate-300"></div>
                        <div class="w-12 h-12 bg-red-500 text-white flex items-center justify-center border border-red-600 text-xs">衝突</div>
                        <div class="w-12 h-12 bg-black text-white flex items-center justify-center border border-slate-800 text-xs">穴</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide">
        <div class="w-full h-20 border-b border-slate-200 flex items-center px-12 bg-white">
            <h2 class="text-2xl font-bold text-slate-800">3. 解決策：行列の積 (sample.py)</h2>
        </div>

        <div class="flex flex-1 p-8 gap-8">
            <div class="w-1/2 flex flex-col justify-center">
                <h3 class="text-xl font-bold text-blue-700 mb-6">中心回転を実現する「行列の積」</h3>
                <p class="text-slate-600 mb-4">
                    単に回転行列 $R$ をかけるのではなく、<br>
                    <span class="font-bold">「平行移動して、回して、戻す」</span>という合成変換を行う。
                </p>
                
                <div class="bg-white p-6 rounded-xl shadow border border-slate-200 text-center space-y-4">
                    <div class="flex items-center justify-center gap-4 text-sm font-mono">
                        <div class="p-3 bg-slate-100 rounded border border-slate-300">
                            <div class="font-bold text-slate-500">Step 1</div>
                            $x - cx$<br>中心へ移動
                        </div>
                        <i class="fas fa-arrow-right text-slate-400"></i>
                        <div class="p-3 bg-blue-100 rounded border border-blue-300">
                            <div class="font-bold text-blue-600">Step 2</div>
                            $R \cdot \mathbf{x}$<br>回転
                        </div>
                        <i class="fas fa-arrow-right text-slate-400"></i>
                        <div class="p-3 bg-slate-100 rounded border border-slate-300">
                            <div class="font-bold text-slate-500">Step 3</div>
                            $+ cx$<br>元の位置へ
                        </div>
                    </div>
                    <div class="border-t border-slate-200 pt-4">
                        <p class="font-serif italic text-xl">
                            $\mathbf{x}' = R(\mathbf{x} - \mathbf{c}) + \mathbf{c}$
                        </p>
                    </div>
                </div>
            </div>

            <div class="w-1/2 flex flex-col">
                <div class="text-sm font-bold text-slate-500 mb-2">sample.py の実装部分</div>
                <div class="code-block text-sm flex-1 overflow-auto">
<span class="comment"># 中心座標の計算</span>
cx = (w - 1) / 2.0
cy = (h - 1) / 2.0

<span class="kw">for</span> y <span class="kw">in</span> <span class="func">range</span>(h):
  <span class="kw">for</span> x <span class="kw">in</span> <span class="func">range</span>(w):
    
    <span class="comment"># 1. 中心基準の座標へ (平行移動 T^-1)</span>
    shift_x = x - cx
    shift_y = y - cy

    <span class="comment"># 2. 回転 (R) + 3. 元へ戻す (平行移動 T)</span>
    <span class="comment"># 式: c * (x-cx) - s * (y-cy) + cx</span>
    res_x = c * shift_x - s * shift_y + cx
    res_y = s * shift_x + c * shift_y + cy

    <span class="comment"># 整数丸め</span>
    x2 = <span class="func">int</span>(<span class="func">round</span>(res_x))
    y2 = <span class="func">int</span>(<span class="func">round</span>(res_y))

    <span class="comment"># 範囲チェック (重要)</span>
    <span class="kw">if</span> 0 <= x2 < w <span class="kw">and</span> 0 <= y2 < h:
        out[y2, x2] = arr[y, x]
                </div>
            </div>
        </div>
    </div>

    <div class="slide">
        <div class="w-full h-20 border-b border-slate-200 flex items-center px-12 bg-white">
            <h2 class="text-2xl font-bold text-slate-800">4. 変換結果の確認</h2>
        </div>

        <div class="flex flex-1 p-8 bg-slate-100 items-center justify-center gap-16">
            
            <div class="flex flex-col items-center">
                <div class="bg-white p-2 shadow-lg rounded transform -rotate-2">
                    <img src="./input.jpeg" alt="Input Image" class="w-64 h-64 object-cover border border-slate-200">
                </div>
                <p class="font-bold mt-4 text-slate-700">元画像 (input.jpeg)</p>
                <p class="text-sm text-slate-500">校舎からの風景</p>
            </div>

            <i class="fas fa-arrow-right text-4xl text-slate-400"></i>

            <div class="flex flex-col items-center">
                <div class="bg-white p-2 shadow-lg rounded transform rotate-2">
                    <img src="./output.png" alt="Output Image" class="w-64 h-64 object-cover border border-slate-200">
                </div>
                <p class="font-bold mt-4 text-blue-700">変換後 (output.png)</p>
                <div class="text-sm text-slate-500 text-center">
                    <p>中心回転: <span class="text-green-600 font-bold">成功</span></p>
                    <p>穴(Holes): <span class="text-slate-400 font-bold">あり (仕様)</span></p>
                </div>
            </div>

        </div>
        
        <div class="h-24 bg-white border-t border-slate-200 p-4 flex items-center justify-center text-center">
            <p class="text-slate-600 text-sm">
                <span class="font-bold text-red-500">Note:</span> 
                「穴」は順方向マッピング(Forward Mapping)の特性としてあえて残した。<br>
                sample.pyにより、画像の消失を防ぎ、意図した通りの構図での回転を実現した。
            </p>
        </div>
    </div>

    <div class="slide bg-slate-800 text-white flex-col justify-center items-center">
        <div class="max-w-4xl text-center">
            <h2 class="text-4xl font-bold mb-12 border-b-2 border-blue-500 inline-block pb-4">
                まとめ：数式からプログラムへ
            </h2>
            
            <div class="grid grid-cols-3 gap-8 text-left mb-16">
                <div class="bg-slate-700 p-6 rounded-lg">
                    <div class="text-blue-400 text-xl mb-2"><i class="fas fa-calculator mr-2"></i>数式の理解</div>
                    <p class="text-slate-300 text-sm">
                        $Ax$ という抽象的な記号が、<br>
                        <span class="font-mono">c*x - s*y</span> という具体的な積和演算に落ちる過程を確認した。
                    </p>
                </div>
                
                <div class="bg-slate-700 p-6 rounded-lg">
                    <div class="text-green-400 text-xl mb-2"><i class="fas fa-layer-group mr-2"></i>行列の積</div>
                    <p class="text-slate-300 text-sm">
                        「回してズレる」問題を、<br>
                        「平行移動との合成」によって解決。<br>
                        行列の積の順序の重要性を学んだ。
                    </p>
                </div>

                <div class="bg-slate-700 p-6 rounded-lg">
                    <div class="text-purple-400 text-xl mb-2"><i class="fas fa-robot mr-2"></i>AIとの協働</div>
                    <p class="text-slate-300 text-sm">
                        45度回転での「崩壊」の原因（デジタル丸め誤差）をAIと共に特定し、実装に反映した。
                    </p>
                </div>
            </div>

            <p class="text-slate-500 text-sm">
                Linear Algebra Final Presentation
            </p>
        </div>
    </div>

</body>
</html>